(()=>{var e={};e.id=603,e.ids=[603],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},1595:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),t(3333),t(996),t(8980);var a=t(170),s=t(5002),i=t(3876),n=t.n(i),o=t(6299),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["(content)",{children:["scanned-item",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3333)),"/home/david-dwiyanto/Documents/Kerja/DBKlik/Warehouse System/warehouse-system-intern-frontend/src/app/(content)/scanned-item/page.tsx"]}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,8980)),"/home/david-dwiyanto/Documents/Kerja/DBKlik/Warehouse System/warehouse-system-intern-frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/home/david-dwiyanto/Documents/Kerja/DBKlik/Warehouse System/warehouse-system-intern-frontend/src/app/(content)/scanned-item/page.tsx"],u="/(content)/scanned-item/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(content)/scanned-item/page",pathname:"/scanned-item",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},787:(e,r,t)=>{Promise.resolve().then(t.bind(t,3814))},9684:(e,r,t)=>{"use strict";t.d(r,{Cg:()=>i,Lw:()=>o,U5:()=>n});var a=t(8727),s=t(1664);let i=async(e,r="",t)=>{let i=(0,s.parseCookies)().token;if(!i)throw Error("No token found");return(await a.Z.get(`/master-item?page=${e}${r?`&query=${r}`:""}&per_page=${t}`,{headers:{Authorization:`Bearer ${i}`}})).data},n=async e=>{let r=(0,s.parseCookies)().token;if(!r)throw Error("No token found");return(await a.Z.post("/master-item",{items:e},{headers:{Authorization:`Bearer ${r}`}})).data},o=async e=>{let r=(0,s.parseCookies)().token;if(!r)throw Error("No token found");return(await a.Z.delete(`/master-item/${e}`,{headers:{Authorization:`Bearer ${r}`}})).data}},3814:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var a=t(7247),s=t(8964),i=t(2569),n=t(9432),o=t(9684),l=t(4030),d=t(3707);let c=()=>{let[e,r]=(0,s.useState)(!1),[t,i]=(0,s.useState)(""),[n,c]=(0,s.useState)("Cari Barang"),[u,m]=(0,s.useState)(null),[x,g]=(0,s.useState)([]),[h,b]=(0,s.useState)(1),[p,y]=(0,s.useState)(!0),[v,f]=(0,s.useState)(!1),[N,j]=(0,s.useState)(!1),[w,k]=(0,s.useState)(""),[S,C]=(0,s.useState)(""),[_,q]=(0,s.useState)({invoiceNumber:"",selectedItem:"",barcodeSN:"",submitError:""}),[P,L]=(0,s.useState)([]),B=(0,d.Z)(t,500),E=async e=>{if(!v&&p){f(!0);try{let r=(await (0,o.Cg)(e,B,10)).data.data;g(t=>1===e?r:[...t,...r]),y(10===r.length)}catch(e){console.error("Error fetching items:",e)}finally{f(!1)}}};(0,s.useEffect)(()=>{(B||""===B)&&(g([]),b(1),y(!0),E(1))},[B]);let $=async()=>{let e=!1;if(q({invoiceNumber:"",selectedItem:"",barcodeSN:"",submitError:""}),w||(q(e=>({...e,invoiceNumber:"Invoice Number is required."})),e=!0),u||(q(e=>({...e,selectedItem:"Please select an item."})),e=!0),S||(q(e=>({...e,barcodeSN:"Barcode SN is required."})),e=!0),P.some(e=>e.barcode_sn.toLowerCase()===S.toLowerCase())&&(q(e=>({...e,barcodeSN:"This Barcode SN is already added."})),e=!0),!e){j(!0);try{let e=await (0,l.Pj)(1,5,w.toLowerCase()),r=await (0,l.Pj)(1,5,S.toLowerCase()),t=e.some(e=>e.invoice_number.toLowerCase()===w.toLowerCase()),a=r.some(e=>e.barcode_sn.toLowerCase()===S.toLowerCase());if(t){q(e=>({...e,invoiceNumber:"Invoice number already exists."})),j(!1);return}if(a){q(e=>({...e,barcodeSN:"Barcode SN already exists."})),j(!1);return}let s={id:u,invoiceNumber:w,sku:n.split(" | ")[0],namaBarang:n.split(" | ")[1],barcode_sn:S,qty:1};L(e=>[...e,s]),C(""),j(!1)}catch(e){console.error("Error checking duplicates:",e),j(!1)}}},I=async e=>{if(e.preventDefault(),0!==P.length){f(!0);try{let e="",r="";for(let t of P){let a=(await (0,l.Pj)(1,5,t.invoiceNumber.toLowerCase())).some(e=>e.invoice_number.toLowerCase()===t.invoiceNumber.toLowerCase()),s=(await (0,l.Pj)(1,5,t.barcode_sn.toLowerCase())).some(e=>e.barcode_sn.toLowerCase()===t.barcode_sn.toLowerCase());if(a&&(e="One or more scanned items have a duplicate invoice number."),s&&(r="One or more scanned items have a duplicate barcode SN."),e||r)break}if(e||r){q(t=>({...t,submitError:`${e} ${r}`.trim()})),f(!1);return}let t=await (0,l.vx)(P);console.log("Items added successfully:",t),k(""),L([]),c("Cari Barang"),m(null),C(""),f(!1)}catch(e){console.error("Error submitting items:",e),f(!1)}}},A=x.filter(e=>e.nama_barang.toLowerCase().includes(B.toLowerCase())||e.sku.toLowerCase().includes(B.toLowerCase()));return(0,a.jsxs)("form",{onSubmit:I,children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("div",{className:"col-span-1",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300",children:"Invoice Number"}),a.jsx("input",{type:"text",placeholder:"Enter Invoice Number",className:"input input-bordered w-full dark:bg-gray-800 dark:border-gray-600 dark:text-gray-200",value:w,onChange:e=>k(e.target.value)}),_.invoiceNumber&&a.jsx("div",{className:"text-red-600 text-sm mt-1",children:_.invoiceNumber})]}),(0,a.jsxs)("div",{className:"relative w-full",children:[a.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"SKU / Nama Barang"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{r(e=>!e),e||E(1)},className:"flex justify-between items-center w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm dark:text-gray-300 dark:bg-gray-800 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-800 focus:ring-gray-200 dark:focus:ring-gray-500",children:[a.jsx("span",{children:n})," ",a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{fillRule:"evenodd",d:"M6.293 9.293a1 1 0 011.414 0L10 11.586l2.293-2.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),e&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-full rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 dark:ring-opacity-10 p-1 max-h-60 overflow-auto z-10",onScroll:e=>{let r=e.currentTarget;if(r.scrollHeight-r.scrollTop<=r.clientHeight+50&&p&&!v){let e=h+1;b(e),E(e)}},children:[a.jsx("input",{value:t,onChange:e=>{let r=e.target.value;i(r),""===r.trim()&&(g([]),b(1),y(!0),E(1))},className:"block w-full px-4 py-2 text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-700 border rounded-md border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-500",type:"text",placeholder:"Search items",autoComplete:"off"}),A.length>0?A.map(e=>(0,a.jsxs)("a",{onClick:()=>{c(`${e.sku} | ${e.nama_barang}`),m(e.id),r(!1)},className:"block px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer",children:[e.sku," | ",e.nama_barang]},e.id)):a.jsx("div",{className:"px-4 py-2 text-gray-500 dark:text-gray-400",children:"No items found"}),v&&a.jsx("div",{className:"px-4 py-2 text-gray-500 dark:text-gray-400",children:"Loading..."})]}),_.selectedItem&&a.jsx("div",{className:"text-red-600 dark:text-red-400 text-sm mt-1",children:_.selectedItem})]}),(0,a.jsxs)("div",{className:"w-full",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300",children:"Barcode SN"}),a.jsx("input",{type:"text",placeholder:"Enter Barcode SN",className:"input input-bordered w-full dark:bg-gray-800 dark:border-gray-600 dark:text-gray-200",value:S,onChange:e=>C(e.target.value)}),_.barcodeSN&&a.jsx("div",{className:"text-red-600 text-sm mt-1",children:_.barcodeSN})]}),a.jsx("button",{type:"button",className:"bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 w-full",onClick:$,disabled:N,children:N?"Adding...":"Add Item"})]})}),a.jsx("div",{className:"col-span-1",children:(0,a.jsxs)("div",{className:"w-full",children:[a.jsx("div",{className:"font-bold",children:"Summary"}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-4 border border-gray-300 dark:border-gray-600 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"Total Quantity (All Invoices):"}),a.jsx("span",{children:P.reduce((e,r)=>e+r.qty,0)})]}),a.jsx("div",{className:"divider -my-2"}),Object.entries(P.reduce((e,r)=>(e[r.invoiceNumber]||(e[r.invoiceNumber]=[]),e[r.invoiceNumber].push(r),e),{})).map(([e,r])=>{let t=r.reduce((e,r)=>e+r.qty,0);return(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{children:["Invoice ",e," Total Quantity:"]}),a.jsx("span",{children:t})]},e)})]})]})})]}),a.jsx("div",{className:"divider"}),(0,a.jsxs)("div",{className:"",children:[P.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Items Preview"}),(0,a.jsxs)("div",{className:"flex my-2",children:[a.jsx("button",{type:"button",className:"btn btn-warning mx-2 btn-sm",onClick:()=>{L(e=>e.slice(0,-1))},disabled:0===P.length,children:"Undo"}),a.jsx("button",{type:"button",className:"btn btn-sm bg-gray-500 text-white",onClick:()=>{L([])},children:"Clear All"})]})]}),Object.entries(P.reduce((e,r)=>(e[r.invoiceNumber]||(e[r.invoiceNumber]=[]),e[r.invoiceNumber].push(r),e),{})).map(([e,r])=>(0,a.jsxs)("div",{className:"collapse collapse-plus bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-md mb-4",children:[a.jsx("input",{type:"checkbox",className:"collapse-checkbox",id:`invoice-${e}`}),(0,a.jsxs)("div",{className:"collapse-title text-xl font-medium",children:["Invoice: ",e]}),a.jsx("div",{className:"collapse-content",children:Object.entries(r.reduce((e,r)=>{let t=`${r.sku} | ${r.namaBarang}`;return e[t]||(e[t]=[]),e[t].push(r),e},{})).map(([e,r])=>{let t=r.reduce((e,r)=>e+r.qty,0);return(0,a.jsxs)("div",{className:"collapse collapse-arrow bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-md mb-2",children:[a.jsx("input",{type:"checkbox",className:"collapse-checkbox",id:`sku-${e}`}),(0,a.jsxs)("div",{className:"collapse-title text-lg font-medium",children:[e,(0,a.jsxs)("span",{className:"ml-4 text-sm text-gray-500 dark:text-gray-400",children:["(Total Quantity: ",t,")"]})]}),a.jsx("div",{className:"collapse-content",children:(0,a.jsxs)("table",{className:"min-w-full table",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"text-left bg-gray-50 dark:bg-gray-700",children:[a.jsx("th",{className:"px-4 py-2 text-gray-700 dark:text-gray-300",children:"Barcode SN"}),a.jsx("th",{className:"px-4 py-2 text-gray-700 dark:text-gray-300",children:"Quantity"})]})}),a.jsx("tbody",{children:r.map(e=>(0,a.jsxs)("tr",{className:"bg-white hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700",children:[a.jsx("td",{className:"px-4 py-2 text-gray-700 dark:text-gray-300",children:e.barcode_sn}),a.jsx("td",{className:"px-4 py-2 text-gray-700 dark:text-gray-300",children:e.qty})]},e.barcode_sn))})]})})]},e)})})]},e))]}),P.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("button",{type:"submit",className:`btn btn-primary w-1/2 ${v?"animate-pulse":""}`,disabled:v,children:v?"Submitting..":"Submit"}),_.submitError&&a.jsx("div",{className:"mt-3 text-red-600 text-sm",children:_.submitError})]})]})]})},u=()=>(0,a.jsxs)("div",{className:"flex min-h-screen dark:bg-gray-900",children:[a.jsx(n.default,{}),(0,a.jsxs)("div",{className:"lg:ml-64 ml-0 flex-1 flex flex-col",children:[a.jsx(i.default,{}),a.jsx("main",{className:"p-6 flex-1",children:a.jsx("div",{className:"card shadow-xl bg-white dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"card-body text-gray-900 dark:text-gray-100",children:[a.jsx("h2",{className:"card-title",children:"Scan SN"}),a.jsx(c,{})]})})})]})]})},3333:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(5347).createProxy)(String.raw`/home/david-dwiyanto/Documents/Kerja/DBKlik/Warehouse System/warehouse-system-intern-frontend/src/app/(content)/scanned-item/page.tsx#default`)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[379,32,511,720,689],()=>t(1595));module.exports=a})();