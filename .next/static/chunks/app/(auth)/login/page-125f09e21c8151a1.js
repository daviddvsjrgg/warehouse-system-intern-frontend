(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{8995:function(e,t,a){Promise.resolve().then(a.bind(a,4995))},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},5752:function(e,t,a){"use strict";a.d(t,{TX:function(){return o},g7:function(){return l},pH:function(){return n}});var r=a(8476),s=a(5037);let n=async e=>{try{let t=await r.Z.post("".concat("/login"),e);if(t.data.success){let e=t.data.data.token;return(0,s.setCookie)(null,"token",e,{path:"/"}),e}throw Error(t.data.message)}catch(a){var t;let e=null===(t=a.response)||void 0===t?void 0:t.data;throw Error((null==e?void 0:e.message)||"Email atau password salah!")}},o=async()=>{try{let e=(0,s.parseCookies)().token;e&&await r.Z.post("".concat("/logout"),{},{headers:{Authorization:"Bearer ".concat(e)}}),localStorage.setItem("onUrl",""),console.log("User logged out successfully."),(0,s.destroyCookie)(null,"token",{path:"/"})}catch(e){console.error("Logout error:",e)}},l=async e=>{try{return(await r.Z.get("".concat("/user"),{headers:{Authorization:"Bearer ".concat(e)}})).data.id}catch(e){throw Error("Failed to fetch user ID from token"+e)}}},4898:function(e,t,a){"use strict";a.d(t,{P:function(){return o},U:function(){return l}});var r=a(5037),s=a(8476);let n=null,o=async()=>{if(n)return n;try{let e=(0,r.parseCookies)().token;return n=(await s.Z.get("".concat("/user"),{headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){return console.error("Error fetching user:",e),null}},l=()=>{n=null}},4995:function(e,t,a){"use strict";a.r(t);var r=a(7437),s=a(2265),n=a(9376),o=a(5752),l=a(2552);t.default=()=>{let[e,t]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),[c,u]=(0,s.useState)(""),[d,h]=(0,s.useState)(!1),m=(0,n.useRouter)(),{refetchUser:p}=(0,l.S)(),f=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,x=async t=>{if(t.preventDefault(),u(""),h(!0),!e||!a){u("Email and password are required."),h(!1);return}if(!f.test(e)){u("Please enter a valid email address."),h(!1);return}try{let t=await (0,o.pH)({email:e,password:a});p(),t||h(!1),m.push("/")}catch(e){u(e.message||"Login failed"),h(!1)}};return(0,r.jsx)("div",{className:"flex justify-center fixed inset-0 items-center bg-blue-50/55",children:(0,r.jsx)("div",{className:"card w-96 bg-base-100 shadow-xl mt-20 mb-20",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsx)("h2",{className:"card-title",children:"Login Warehouse System"}),(0,r.jsxs)("form",{onSubmit:x,children:[(0,r.jsxs)("div",{className:"items-center mt-2",children:[(0,r.jsxs)("label",{htmlFor:"email",className:"input input-bordered flex items-center gap-2 mb-2",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 opacity-70",children:[(0,r.jsx)("path",{d:"M2.5 3A1.5 1.5 0 0 0 1 4.5v.793c.026.009.051.02.076.032L7.674 8.51c.206.1.446.1.652 0l6.598-3.185A.755.755 0 0 1 15 5.293V4.5A1.5 1.5 0 0 0 13.5 3h-11Z"}),(0,r.jsx)("path",{d:"M15 6.954 8.978 9.86a2.25 2.25 0 0 1-1.956 0L1 6.954V11.5A1.5 1.5 0 0 0 2.5 13h11a1.5 1.5 0 0 0 1.5-1.5V6.954Z"})]}),(0,r.jsx)("input",{id:"email",type:"text",className:"grow",placeholder:"Email",value:e,onChange:e=>t(e.target.value)})]}),(0,r.jsxs)("label",{htmlFor:"password",className:"input input-bordered flex items-center gap-2 mb-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-4 h-4 opacity-70",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z",clipRule:"evenodd"})}),(0,r.jsx)("input",{id:"password",type:"password",placeholder:"Password",className:"grow",value:a,onChange:e=>i(e.target.value)})]})]}),c&&(0,r.jsx)("p",{className:"text-red-500 text-sm mt-2 p-1",children:c}),(0,r.jsx)("div",{className:"form-control",children:(0,r.jsxs)("label",{className:"label cursor-pointer",children:[(0,r.jsx)("span",{className:"label-text",children:"Remember me"}),(0,r.jsx)("input",{type:"checkbox",className:"checkbox"})]})}),(0,r.jsxs)("div",{className:"card-actions justify-end",children:[(0,r.jsx)("button",{type:"submit",className:"btn text-white bg-gray-800 hover:bg-gray-900 w-full",disabled:d,children:d?"Logging in...":"Login"}),(0,r.jsx)("a",{className:"label-text underline cursor-pointer",children:"Forgot Your Password?"})]})]})]})})})}},2552:function(e,t,a){"use strict";a.d(t,{S:function(){return i},UserProvider:function(){return l}});var r=a(7437),s=a(2265),n=a(4898);let o=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[a,l]=(0,s.useState)(null),[i,c]=(0,s.useState)(!0),u=async()=>{c(!0),l(await (0,n.P)()),c(!1)};(0,s.useEffect)(()=>{u()},[]);let d=async()=>{await u()};return(0,r.jsx)(o.Provider,{value:{user:a,loading:i,refetchUser:d},children:t})},i=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useUserContext must be used within a UserProvider");return e}},8476:function(e,t,a){"use strict";let r=a(3464).Z.create({baseURL:"https://api-backend-ws-david-intern.vercel.app/api/api",headers:{"Content-Type":"application/json"}});t.Z=r}},function(e){e.O(0,[207,971,117,744],function(){return e(e.s=8995)}),_N_E=e.O()}]);